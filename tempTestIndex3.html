<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Toronto Games Week</title>

    <!-- Stylesheets -->
    <link href="tempTestCss2.css" rel="stylesheet" type="text/css" />
    <link href="https://fonts.googleapis.com/css2?family=PT+Mono&display=swap" rel="stylesheet" />

    <style>
      .image-container {
        position: relative;
        width: 100%;
        height: auto;
        z-index: 1;
      }

      .contentContainer {
        position: relative;
        z-index: 2;
      }

      canvas {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        pointer-events: auto;
      }

      header {
        position: fixed;
        width: 100%;
        z-index: 1000;
        top: 0;
      }

      .controls {
        position: fixed;
        top: 160px;
        right: 20px;
        background: rgba(255, 255, 255, 0.9);
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        max-width: 300px;
        max-height: 90vh;
        overflow-y: auto;
        z-index: 999;
      }

      .effect-buttons {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
        margin-bottom: 15px;
      }

      .effect-btn {
        padding: 8px 12px;
        border: none;
        border-radius: 4px;
        background: #f0f0f0;
        cursor: pointer;
        transition: background 0.3s;
      }

      .effect-btn.active {
        background: #007bff;
        color: white;
      }

      .slider-container {
        margin: 10px 0;
      }

      .slider-label {
        display: flex;
        justify-content: space-between;
        margin-bottom: 5px;
      }

      input[type="range"] {
        width: 100%;
        margin: 5px 0;
      }

      .controls-row {
        display: flex;
        justify-content: space-between;
        margin: 10px 0;
      }

      .blend-select {
        width: 100%;
        margin: 10px 0;
        padding: 5px;
      }
    </style>
  </head>

  <body>
    <header>
      <input type="checkbox" id="nav-toggle" class="nav-toggle" />
      <label for="nav-toggle" class="nav-toggle-label">
        <span></span>
      </label>

      <nav>
        <ul>
          <li>
            <a href="index.html">Home</a>
          </li>

          <li>
            <a href="about.html" id="aboutNav">About</a>
          </li>
        </ul>
      </nav>
    </header>

    <div class="image-container">
      <canvas id="myCanvas" width="500" height="400"></canvas>
    </div>
    
    <div class="controls">
      <div class="effect-buttons">
        <button class="effect-btn active" data-effect="brush">Brush</button>
        <button class="effect-btn" data-effect="grid">Grid</button>
        <!-- <button class="effect-btn" data-effect="dissolve">Dissolve</button> -->
        <button class="effect-btn" data-effect="particles">Particles</button>
        <!-- <button class="effect-btn" data-effect="shatter">Shatter</button> -->
        <!-- <button class="effect-btn" data-effect="detail">Details</button> -->


      </div>

      <div class="slider-container">
        <div class="slider-label">
          <span>Size</span>
          <span id="sizeValue">30</span>
        </div>
        <input type="range" id="sizeSlider" min="5" max="100" value="30" />
      </div>

      <div class="slider-container" id="speedControl">
        <div class="slider-label">
          <span>Speed</span>
          <span id="speedValue">50</span>
        </div>
        <input type="range" id="speedSlider" min="1" max="100" value="50" />
      </div>

      <div class="slider-container" id="particleCountControl">
        <div class="slider-label">
          <span>Particle Count</span>
          <span id="particleCountValue">3</span>
        </div>
        <input type="range" id="particleCountSlider" min="1" max="20" value="3" />
      </div>

      <div class="slider-container" id="gravityControl">
        <div class="slider-label">
          <span>Gravity</span>
          <span id="gravityValue">0.5</span>
        </div>
        <input type="range" id="gravitySlider" min="0" max="100" value="50" />
      </div>

      <div class="slider-container" id="rotationControl">
        <div class="slider-label">
          <span>Rotation Speed</span>
          <span id="rotationValue">50</span>
        </div>
        <input type="range" id="rotationSlider" min="0" max="100" value="50" />
      </div>

      <div class="slider-container" id="spreadControl">
        <div class="slider-label">
          <span>Spread Radius</span>
          <span id="spreadValue">50</span>
        </div>
        <input type="range" id="spreadSlider" min="10" max="200" value="50" />
      </div>

      <div class="slider-container" id="opacityControl">
        <div class="slider-label">
          <span>Opacity</span>
          <span id="opacityValue">27</span>
        </div>
        <input type="range" id="opacitySlider" min="0" max="100" value="100" />
      </div>

      <div class="slider-container" id="blurControl">
        <div class="slider-label">
          <span>Motion Blur</span>
          <span id="blurValue">0</span>
        </div>
        <input type="range" id="blurSlider" min="0" max="20" value="0" />
      </div>

      <div class="controls-row">
        <label> <input type="checkbox" id="trailToggle" /> Trail Effect </label>
        <label> <input type="checkbox" id="bounceToggle" /> Bounce </label>
      </div>

      <select id="blendMode" class="blend-select">
        <option value="source-over">Normal</option>
        <option value="multiply">Multiply</option>
        <option value="screen">Screen</option>
        <option value="overlay">Overlay</option>
        <option value="darken">Darken</option>
        <option value="lighten">Lighten</option>
      </select>
    </div>

    <main>
      <div class="headerImgDiv">
        <img id="letterImg" src="images/TGWLogo2025wCap.png" alt="A type treatment of Toronto Games Week" />
        <p id="caption">A celebration of playable arts & culture</p>
        <p id="date">June 11-17, 2025</p>
        <br />

        <div class="contentContainer" id="landingPage">
          <div class="content">
            <section class="textBox">
              <h2></h2>
              <p>
                Toronto Games Week is a collective coordination of events organized independently by dozens of organizations, curators, companies,
                creators, and communities.
              </p>
              <br />
              <br />

              <p>Be the first to find out about TGW 2025 by subscribing to our newsletter:</p>
              <!-- <div id="newsletterSignup">
              <script
                async
                data-form="be714392-42fd-11ef-8cf4-057b9b18e38a"
                src="https://eocampaign1.com/form/be714392-42fd-11ef-8cf4-057b9b18e38a.js"></script>
            </div> -->
            </section>
          </div>

          <div class="content">
            <section class="textBox">
              <h2>At Toronto Games Week, you might:</h2>
              <ul class="controllerList">
                <li>Frolic in a flickering forest pop-up arcade after dark!</li>
                <li>Learn open source game tools at a workshop!</li>
                <li>Play or cheer at a women & femme speedrunning event!</li>
                <li>Brew a DIY blend at a tea party in the park!</li>
                <li>Compare working class sci-fi movies and games!</li>
                <li>Install a game you made on a Gameboy cartridge!</li>
              </ul>
              <div class="btndiv">
                <p class="btn floatingBtn">
                  <a class="" target="_blank" href="blog/2023.html">2023 recap</a>
                </p>

                <p class="btn floatingBtn">
                  <a class="" target="_blank" href="blog/2024.html">2024 recap</a>
                </p>
              </div>
            </section>
          </div>

          <div class="content">
            <section class="textBox">
              <h2>Organize an event!</h2>
              <p>
                If you'd like to run a TGW event yourself, there's still time to get in on the fun! We're open to including board/escape
                room/theatrical/LARPing -- playful culture of all sorts, not just screen based games!
              </p>
              <p class="btn floatingBtn">
                <a
                  href="https://docs.google.com/forms/d/e/1FAIpQLSfj5hbgpI-ATNYESbEnNVPaAeONATGXkaEzocRHVB-QRziiyA/viewform?usp=sf_link"
                  target="_blank"
                  >Submit an Event</a
                >
              </p>
            </section>
          </div>

          <div class="content">
            <section class="textBox">
              <h2>Help out</h2>
              <p>
                Would you like to volunteer and help the coalition of community organizations and not-for-profits that make it happen? There's lots of
                interesting things to do!
              </p>
              <p class="btn floatingBtn floatingBtnBlue">
                <a
                  href="https://docs.google.com/forms/d/e/1FAIpQLSct8eZvHVT46la0WTR1Lq1Nx_6KS3dEgumXNNak-TG3MbB0Uw/viewform?usp=sf_link"
                  target="_blank"
                  >Volunteer</a
                >
              </p>
            </section>
          </div>

          <div class="content">
            <section class="textBox">
              <h2>Contact</h2>
              <p>
                Reach out with any questions to <a href="mailto:marie@gameartsinternational.network">Marie LeBlanc Flanagan</a> or
                <a href="mailto:jim@gameartsinternational.network">Jim Munroe</a>.
              </p>
            </section>
          </div>
        </div>
      </div>

      <div id="inventory"></div>
    </main>
    <script>
      // Get DOM elements
     

      const canvas = document.getElementById("myCanvas");
      const ctx = canvas.getContext("2d");
      const effectButtons = document.querySelectorAll(".effect-btn");

      // Get all control elements
      const sizeSlider = document.getElementById("sizeSlider");
      const speedSlider = document.getElementById("speedSlider");
      const particleCountSlider = document.getElementById("particleCountSlider");
      const gravitySlider = document.getElementById("gravitySlider");
      const rotationSlider = document.getElementById("rotationSlider");
      const spreadSlider = document.getElementById("spreadSlider");
      const opacitySlider = document.getElementById("opacitySlider");
      const blurSlider = document.getElementById("blurSlider");
      const trailToggle = document.getElementById("trailToggle");
      const bounceToggle = document.getElementById("bounceToggle");
      const blendSelect = document.getElementById("blendMode");

      const bwImage = new Image();
      const colorImage = new Image();
      let currentEffect = "brush";
      let lastX = 0,
        lastY = 0;
      let isFirstTouch = true;
      let particles = [];
      let dissolvePixels = new Set();
      let animationFrameId = null;

      function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = bwImage.naturalHeight * (window.innerWidth / bwImage.naturalWidth);
  
  if (bwImage.complete) {
    ctx.drawImage(bwImage, 0, 0, canvas.width, canvas.height);
  }
}
      class ShatterPiece {
        constructor(x, y, size) {
          this.x = x;
          this.y = y;
          this.size = size * (0.5 + Math.random() * 0.5);
          this.rotation = Math.random() * Math.PI * 2;
          this.gravity = parseFloat(gravitySlider.value) / 100;
          const spread = spreadSlider.value / 50;
          this.velocityX = (Math.random() - 0.5) * 2 * (speedSlider.value / 25) * spread;
          this.velocityY = (Math.random() - 15) * 2 * (speedSlider.value / 25) * spread;
          this.rotationSpeed = (Math.random() - 0.5) * 0.4 * (rotationSlider.value / 50);
          this.opacity = opacitySlider.value / 100;
          this.points = this.generatePoints();
          this.bounceCount = 0;
        }

        generatePoints() {
          const points = [];
          const angles = [
            (Math.random() * Math.PI) / 4,
            Math.PI / 2 + (Math.random() * Math.PI) / 4,
            Math.PI + (Math.random() * Math.PI) / 4,
            Math.PI * 1.5 + (Math.random() * Math.PI) / 4,
          ];
          angles.forEach((angle) => {
            const distance = this.size * (0.5 + Math.random() * 0.5);
            points.push({
              x: Math.cos(angle) * distance,
              y: Math.sin(angle) * distance,
            });
          });
          return points;
        }

        update() {
          this.velocityY += this.gravity;
          this.x += this.velocityX;
          this.y += this.velocityY;
          this.rotation += this.rotationSpeed;

          if (bounceToggle.checked && this.y > canvas.height - 10 && this.bounceCount < 2) {
            this.velocityY = -this.velocityY * 0.6;
            this.velocityX *= 0.8;
            this.y = canvas.height - 10;
            this.bounceCount++;
          }

          return this.y < canvas.height + 100 && this.opacity > 0.01;
        }

        draw(context) {
          context.save();
          context.globalAlpha = this.opacity;
          if (blurSlider.value > 0) {
            context.filter = `blur(${(blurSlider.value * Math.abs(this.velocityY)) / 20}px)`;
          }
          context.translate(this.x, this.y);
          context.rotate(this.rotation);
          context.beginPath();
          context.moveTo(this.points[0].x, this.points[0].y);
          for (let i = 1; i < this.points.length; i++) {
            context.lineTo(this.points[i].x, this.points[i].y);
          }
          context.closePath();
          context.fill();
          context.restore();

          if (!trailToggle.checked) {
            this.opacity *= 0.97;
          }
        }
      }

      function getCoords(e) {
        const rect = canvas.getBoundingClientRect();
        const clientX = e.clientX || e.touches?.[0]?.clientX || lastX;
        const clientY = e.clientY || e.touches?.[0]?.clientY || lastY;
        return {
          x: (clientX - rect.left) * (canvas.width / rect.width),
          y: (clientY - rect.top) * (canvas.height / rect.height),
        };
      }

      function draw(e) {
        const coords = getCoords(e);

        if (isFirstTouch) {
          lastX = coords.x;
          lastY = coords.y;
          isFirstTouch = false;
          return;
        }

        ctx.globalCompositeOperation = "destination-out";

        switch (currentEffect) {
          case "brush":
            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            ctx.lineTo(coords.x, coords.y);
            ctx.lineWidth = sizeSlider.value;
            ctx.lineCap = "round";
            ctx.stroke();
            break;

          case "grid":
            const size = sizeSlider.value;
            const gridX = Math.floor(coords.x / size) * size;
            const gridY = Math.floor(coords.y / size) * size;
            ctx.fillRect(gridX, gridY, size, size);
            break;

          case "dissolve":
            const dissolveCount = Math.floor(speedSlider.value / 5);
            const spread = spreadSlider.value;
            for (let i = 0; i < dissolveCount; i++) {
              const rx = coords.x + (Math.random() - 0.5) * spread;
              const ry = coords.y + (Math.random() - 0.5) * spread;
              ctx.beginPath();
              ctx.arc(rx, ry, Math.random() * 2 + 1, 0, Math.PI * 2);
              ctx.fill();
            }
            break;

          case "particles":
            const particleCount = parseInt(particleCountSlider.value);
            const particleSpeed = speedSlider.value / 10;
            const particleSpread = spreadSlider.value / 50;
            particles.push(
              ...Array(particleCount)
                .fill()
                .map(() => ({
                  x: coords.x,
                  y: coords.y,
                  vx: (Math.random() - 0.5) * particleSpeed * particleSpread,
                  vy: (Math.random() - 0.5) * particleSpeed * particleSpread,
                  size: Math.random() * sizeSlider.value * 0.3 + 2,
                  opacity: opacitySlider.value / 100,
                }))
            );

            particles.forEach((p) => {
              p.x += p.vx;
              p.y += p.vy;
              if (!trailToggle.checked) p.opacity *= 0.95;
              ctx.globalAlpha = p.opacity;
              ctx.beginPath();
              ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
              ctx.fill();
            });

            particles = particles.filter((p) => p.x > 0 && p.x < canvas.width && p.y > 0 && p.y < canvas.height && p.opacity > 0.01);
            break;
        }

        ctx.globalCompositeOperation = "destination-over";
        const ratio = colorImage.naturalHeight / colorImage.naturalWidth;
        const width = canvas.width;
        const height = width * ratio;
        ctx.drawImage(colorImage, 0, 0, width, height);

        lastX = coords.x;
        lastY = coords.y;
      }

      effectButtons.forEach((button) => {
        button.addEventListener("click", () => {
          if (animationFrameId) {
            cancelAnimationFrame(animationFrameId);
          }

          effectButtons.forEach((btn) => btn.classList.remove("active"));
          button.classList.add("active");
          currentEffect = button.dataset.effect;

          ctx.clearRect(0, 0, canvas.width, canvas.height);
          const ratio = bwImage.naturalHeight / bwImage.naturalWidth;
          const width = canvas.width;
          const height = width * ratio;
          ctx.drawImage(bwImage, 0, 0, width, height);

          particles = [];
          dissolvePixels.clear();

          // Show/hide controls based on effect
          const showParticleControls = ["particles", "shatter"].includes(currentEffect);
          const showSpeedControl = ["particles", "shatter", "dissolve"].includes(currentEffect);
          const showGravityControl = currentEffect === "shatter";
          const showRotationControl = currentEffect === "shatter";
          const showSpreadControl = ["particles", "shatter", "dissolve"].includes(currentEffect);
          const showOpacityControl = ["particles", "shatter"].includes(currentEffect);
          const showBlurControl = ["particles", "shatter"].includes(currentEffect);
          const showTrailBounce = ["particles", "shatter"].includes(currentEffect);

          document.getElementById("particleCountControl").style.display = showParticleControls ? "block" : "none";
          document.getElementById("speedControl").style.display = showSpeedControl ? "block" : "none";
          document.getElementById("gravityControl").style.display = showGravityControl ? "block" : "none";
          document.getElementById("rotationControl").style.display = showRotationControl ? "block" : "none";
          document.getElementById("spreadControl").style.display = showSpreadControl ? "block" : "none";
          document.getElementById("opacityControl").style.display = showOpacityControl ? "block" : "none";
          document.getElementById("blurControl").style.display = showBlurControl ? "block" : "none";
          document.querySelector(".controls-row").style.display = showTrailBounce ? "flex" : "none";
          blendSelect.style.display = showBlurControl ? "block" : "none";
        });
      });

      function updateValueDisplay(slider, valueElement) {
        document.getElementById(valueElement).textContent = slider.value;
      }

      sizeSlider.addEventListener("input", () => updateValueDisplay(sizeSlider, "sizeValue"));
      speedSlider.addEventListener("input", () => updateValueDisplay(speedSlider, "speedValue"));
      particleCountSlider.addEventListener("input", () => updateValueDisplay(particleCountSlider, "particleCountValue"));
      gravitySlider.addEventListener("input", () => {
        const value = (gravitySlider.value / 100).toFixed(2);
        document.getElementById("gravityValue").textContent = value;
      });
      rotationSlider.addEventListener("input", () => updateValueDisplay(rotationSlider, "rotationValue"));
      spreadSlider.addEventListener("input", () => updateValueDisplay(spreadSlider, "spreadValue"));
      opacitySlider.addEventListener("input", () => updateValueDisplay(opacitySlider, "opacityValue"));
      blurSlider.addEventListener("input", () => updateValueDisplay(blurSlider, "blurValue"));

      canvas.addEventListener("mousemove", draw);
      canvas.addEventListener("touchmove", (e) => {
        e.preventDefault();
        draw(e);
      });

      canvas.addEventListener("mouseout", () => (isFirstTouch = true));
      canvas.addEventListener("touchend", () => (isFirstTouch = true));

      window.addEventListener("resize", resizeCanvas);

      // Initialize control visibility
      document.getElementById("particleCountControl").style.display = "none";
      document.getElementById("speedControl").style.display = "none";
      document.getElementById("gravityControl").style.display = "none";
      document.getElementById("rotationControl").style.display = "none";
      document.getElementById("spreadControl").style.display = "none";
      document.getElementById("opacityControl").style.display = "none";
      document.getElementById("blurControl").style.display = "none";
      document.querySelector(".controls-row").style.display = "none";
      blendSelect.style.display = "none";

      bwImage.onload = () => {
        resizeCanvas();
      };

      colorImage.onload = () => {
        resizeCanvas();
      };

      bwImage.src = "images/bw.jpg";
      colorImage.src = "images/background.png";
    </script>
  </body>
</html>
