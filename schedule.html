<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Toronto Games Week</title>

    <!-- Stylesheets -->
    <link href="../styles.css" rel="stylesheet" type="text/css" />
    <link
      href="https://fonts.googleapis.com/css2?family=PT+Mono&display=swap"
      rel="stylesheet"
    />

    <!-- Meta Tags -->
    <meta name="author" content="Marie Claire LeBlanc Flanagan" />
    <meta name="description" content="Celebrating games in Toronto, Canada" />

    <!--a Open Graph Tags -->
    <meta property="og:title" content="Toronto Games Week" />
    <meta
      property="og:description"
      content="Celebrating games in Toronto, Canada"
    />
    <meta
      property="og:image"
      content="https://torontogamesweek.com/images/tgwposternologos.png"
    />
    <meta property="og:url" content="https://torontogamesweek.com" />
    <meta property="og:type" content="webpage" />

    <!-- Twitter Tags -->
    <meta name="twitter:title" content="Toronto Games Week" />
    <meta
      name="twitter:description"
      content="Celebrating games in Toronto, Canada"
    />
    <meta
      name="twitter:image"
      content="images/TGWSocialSmall.png"
      id="indexImage"
    />
    <meta name="twitter:card" content="summary_large_image" />

    <style>
      /* Base canvas setup */
      canvas {
        position: absolute; /* Mobile default */
        width: 100%;
        background-image: none;
        height: auto;
        left: 0;
        top: 0;
      }

      .image-container {
        position: relative;
        top: 0;
        left: 0;
        width: 100%;
        height: calc(
          1000px * (9 / 16)
        ); /* Assuming 16:9 aspect ratio, adjust to match actual image ratio */
      }

      main {
        position: relative;
        z-index: 1;
        margin-top: 0;
        background-color: none;
      }

      .contentContainer {
        position: relative;
        z-index: 1;
      }

      /* Content container setup */
      .contentContainer,
      .sponsorBox {
        position: relative;
        z-index: 1;
        pointer-events: none;
      }

      .headerImgDiv {
        z-index: 1;
        pointer-events: none;
        background-color: transparent;
      }

      /* Main content areas */
      .content {
        pointer-events: none;
      }

      .textBox {
        background-color: hsla(0, 0%, 100%, 0.9);
        pointer-events: none;
        text-align: center;
        /* max-width: 98vw; */
        /* padding: 4rem 10rem; */
      }

      @media (min-width: 768px) {
        .textBox {
          /* padding: 4rem 10rem; */
        }
      }

      /* Re-enable pointer events for specific interactive elements */
      .contentContainer > * .headerImgDiv img,
      .btn,
      .floatingBtn,
      .textBox > * {
        pointer-events: all;
        z-index: 2;
      }

      /* Header */
      nav {
        position: static;
      }

      nav a {
        pointer-events: auto;
        background-color: white;
      }

      nav ul {
        background-color: rgb(255, 255, 255);
      }

      @media screen and (min-width: 900px) {
      }

      @media (min-width: 768px) {
        header {
          height: 0;
        }

        canvas {
          position: absolute; /* Reset for desktop */
        }

        nav li,
        nav ul,
        nav {
          background-color: rgba(255, 255, 255, 0);
          padding: 10px 10px 0 10px;
        }

        nav {
          margin: 0;
          padding: 0;
          background-color: rgba(255, 255, 255, 0);
        }
        nav a {
          color: rgb(45, 45, 45); /* Adjust based on background */
          text-shadow: 0 0 5px white; /* Soft glow effect */
          background-color: rgba(255, 255, 255, 0);
        }

        nav > ul > li {
          font-size: 1.5rem;
          margin: 0 10px;
        }

        header {
          position: relative;
        }
      }

      /* Mobile styles */
      @media (max-width: 768px) {
        .sponsorBox {
          margin: 4rem 0 0 0;
        }

        .logo-container {
          grid-template-columns: repeat(3, 1fr);
          gap: 1rem;
        }

        .logo-slot {
          width: 100px;
          height: 60px;
        }

        /* Hide slots 4-6 on mobile */
        .logo-slot:nth-child(n + 4) {
          display: none;
        }
      }

      .no-pointer-events {
        pointer-events: none;
      }

      /* Base */
      main {
        position: relative;
        z-index: 1;
      }
    </style>
  </head>

  <body>
    <header>
      <button
        id="nav-toggle"
        aria-expanded="false"
        aria-controls="primary-navigation"
        class="nav-toggle-button"
      >
        <span class="sr-only">Menu</span>
        <span class="icon"></span>
      </button>

      <div></div>
    </header>
    <!-- 
    <div class="i`age-container">
      <canvas id="myCanvas" width="500" height="400"></canvas>
    </div> -->
    <main class="no-pointer-events">
      <!-- Add HTML here -->
      <nav id="primary-navigation">
        <ul>
          <li>
            <a href="./index.html">Home</a>
          </li>
          <li>
            <a href="schedule.html" id="scheduleNav">Schedule</a>
          </li>
          <li>
            <a href="about.html" id="aboutNav">About</a>
          </li>
        </ul>
      </nav>
      <div id="schedule-container"></div>
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const navToggle = document.getElementById("nav-toggle");
        const primaryNav = document.getElementById("primary-navigation");

        navToggle.addEventListener("click", function () {
          const isExpanded = navToggle.getAttribute("aria-expanded") === "true";
          navToggle.setAttribute("aria-expanded", !isExpanded);
          primaryNav.classList.toggle("expanded");
        });
      });
    </script>
    <script>
      // Add Javascript Here
      class Event {
        constructor(name, hook, description, date, location, link) {
          this.name = name;
          this.hook = hook;
          this.description = description;
          this.date = date;
          this.location = location;
          this.link = link;
        }
      }

      const events = [];
      const SHEET_ID = "1nfs459EuPLSICm9QbCI9EcQoyJ9T6hfXQPzogEYaW_4";
      const SHEET_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv`;

      async function fetchSheetData() {
        try {
          const response = await fetch(SHEET_URL);
          const csvText = await response.text();
          let semicolonCsv = csvText.replace(
            /,(?=(?:(?:[^"]*"){2})*[^"]*$)/g,
            ";"
          );

          // Parse CSV
          const rows = semicolonCsv
            .split("\n")
            .map((row) =>
              row.split(";").map((cell) => cell.replace(/^"|"$/g, ""))
            ); // Remove quotes

          // Skip header row and process data
          for (let i = 1; i < rows.length; i++) {
            const name = rows[i][1] || "";
            const hook = rows[i][5] || "";
            const description = rows[i][6] || "";
            const date = rows[i][2] || "";
            const location = rows[i][4] || "";
            const link = rows[i][22]?.includes("http") ? rows[i][22] : "";

            if (events.some((event) => event.name === name)) {
              continue; // Skip duplicate events
            }

            if (!name || name == "Incomplete") {
              continue; // Skip incomplete rows
            }

            events.push(
              new Event(name, hook, description, date, location, link)
            );
          }

          console.log("Fetched events:", events);
          return events;
        } catch (error) {
          console.error("Error fetching sheet data:", error);
          return [];
        }
      }

      function displayEvents(events) {
        const container = document.getElementById("schedule-container");
        container.innerHTML = ""; // Clear previous content

        events.forEach((event) => {
          const eventDiv = document.createElement("div");
          eventDiv.className = "event";
          // <img src="/images/creatures2024/31.png" alt="NIGHT" class="eventIcon" />
          eventDiv.innerHTML = `
            <section class="textBox">
              <h3 class="date">${event.date}</h3>
              <div class="DescAndImg">
                <div class="desc">
                  <h2 class="title">${event.name}</h2>
                  <p class="details">
                    ${event.description}
                  </p>
                </div>
              </div>
              <p class="location"><span aria-hidden="true">üìç</span>~???????~</p>
              ${
                event.link
                  ? `<a href="${event.link}" target="_blank">Link</a>`
                  : ``
              }
            </section>
          `;
          container.appendChild(eventDiv);
        });
      }

      function handleLoaaded() {
        fetchSheetData()
          .then((events) => {
            displayEvents(events);
          })
          .catch((error) => {
            console.error("Error displaying events:", error);
          });
      }

      // Call the function when the page loads
      document.addEventListener("DOMContentLoaded", handleLoaaded);
    </script>
  </body>
</html>
